<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workflow Dashboard</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>Workflow</h2>
            </div>
            <nav class="sidebar-nav">
                <a href="#" class="nav-link active" data-view="dashboard-view"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
                <a href="#" class="nav-link" data-view="my-tasks-view"><i class="fas fa-tasks"></i> My Tasks</a>
                <a href="#" class="nav-link" data-view="my-leave-view"><i class="fas fa-calendar-alt"></i> My Leave</a>
                
                <!-- Manager role ONLY links -->
                <a href="#" class="nav-link hidden role-manager" data-view="assign-task-view"><i class="fas fa-plus-circle"></i> Assign Task</a>
                <a href="#" class="nav-link hidden role-manager" data-view="leave-approval-view"><i class="fas fa-check-circle"></i> Leave Approvals</a>
                
                <!-- Admin role ONLY link -->
                <a href="#" class="nav-link hidden role-admin" data-view="user-management-view"><i class="fas fa-users-cog"></i> User Management</a>
            </nav>
            <div class="sidebar-footer">
                <form action="/logout" method="post" id="logout-form">
                    <button type="submit" class="logout-button">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </form>
            </div>
        </aside>
        <main class="main-content">
            <header class="main-header">
                <h1 id="view-title">Dashboard</h1>
                <div class="user-info">
                    <span id="user-fullname">Loading...</span>
                    <span id="user-role" class="role-badge"></span>
                </div>
            </header>
            <div class="content-wrapper">
                <section id="dashboard-view" class="view active-view">
                    <div class="dashboard-cards">
                        <div class="card"><h3>My Open Tasks</h3><p class="card-stat" id="dashboard-open-tasks">0</p></div>
                        <div class="card"><h3>My Leave Requests</h3><p class="card-stat" id="dashboard-leave-requests">0</p></div>
                        <div class="card hidden role-manager role-admin"><h3>Pending Approvals</h3><p class="card-stat" id="dashboard-pending-approvals">0</p></div>
                        <div class="card hidden role-admin"><h3>Total Users</h3><p class="card-stat" id="dashboard-total-users">0</p></div>
                    </div>
                    <div id="dashboard-employee-section">
                        <h3 id="manager-info" class="hidden" style="font-weight: 400; margin-bottom: 20px;"></h3>
                        <h2>My Recent Tasks</h2>
                        <table class="data-table">
                            <thead><tr><th>Title</th><th>Status</th><th>Due Date</th></tr></thead>
                            <tbody id="dashboard-my-tasks-list"></tbody>
                        </table>
                    </div>
                    <div id="dashboard-approval-section" class="hidden role-manager" style="margin-top: 30px;">
                        <h2>Pending Leave Approvals</h2>
                        <table class="data-table">
                            <thead><tr><th>Employee</th><th>Type</th><th>Dates</th><th>Action</th></tr></thead>
                            <tbody id="dashboard-leave-approval-list"></tbody>
                        </table>
                    </div>
                    <div id="dashboard-manager-tasks-section" class="hidden role-manager" style="margin-top: 30px;">
                        <h2>Tasks I've Assigned</h2>
                        <table class="data-table">
                            <thead><tr><th>Title</th><th>Assigned To</th><th>Status</th><th>Due Date</th></tr></thead>
                            <tbody id="dashboard-assigned-by-me-list"></tbody>
                        </table>
                    </div>
                </section>
                <section id="my-tasks-view" class="view">
                    <table class="data-table">
                        <thead><tr><th>Title</th><th>Description</th><th>Assigned By</th><th>Due Date</th><th>Status</th><th>Action</th></tr></thead>
                        <tbody id="my-tasks-table-body"></tbody>
                    </table>
                </section>
                <section id="my-leave-view" class="view">
                    <div class="action-header"><h2>My Leave History</h2><button class="btn btn-primary" id="apply-leave-btn">Apply for Leave</button></div>
                    <table class="data-table">
                        <thead><tr><th>Type</th><th>Start Date</th><th>End Date</th><th>Reason</th><th>Status</th></tr></thead>
                        <tbody id="my-leave-table-body"></tbody>
                    </table>
                </section>
                <section id="assign-task-view" class="view">
                    <div class="form-container">
                        <h2>Assign a New Task</h2>
                        <form id="assign-task-form"><div class="input-group"><label for="task-title">Title</label><input type="text" id="task-title" required></div><div class="input-group"><label for="task-description">Description</label><textarea id="task-description" rows="3"></textarea></div><div class="input-group"><label for="task-due-date">Due Date</label><input type="date" id="task-due-date" required></div><div class="input-group"><label for="task-assign-to">Assign To</label><select id="task-assign-to" required></select></div><button type="submit" class="btn btn-primary">Assign Task</button></form>
                    </div>
                </section>
                <section id="leave-approval-view" class="view">
                    <table class="data-table">
                        <thead><tr><th>Employee</th><th>Type</th><th>Dates</th><th>Reason</th><th>Action</th></tr></thead>
                        <tbody id="leave-approval-table-body"></tbody>
                    </table>
                </section>
                <section id="user-management-view" class="view">
                    <div class="action-header"><h2>All Users</h2><button class="btn btn-primary" id="create-user-btn">Create New User</button></div>
                    <table class="data-table">
                        <thead><tr><th>Full Name</th><th>Username</th><th>Email</th><th>Role</th><th>Manager</th><th>Actions</th></tr></thead>
                        <tbody id="user-management-table-body"></tbody>
                    </table>
                </section>
            </div>
        </main>
    </div>
    <div id="modal-container" class="modal-container hidden">
        <div id="apply-leave-modal" class="modal-content hidden">
            <h2>Apply for Leave</h2>
            <form id="apply-leave-form"><div class="input-group"><label for="leave-type">Leave Type</label><input type="text" id="leave-type" placeholder="e.g., Sick Leave, Vacation" required></div><div class="input-group"><label for="leave-start-date">Start Date</label><input type="date" id="leave-start-date" required></div><div class="input-group"><label for="leave-end-date">End Date</label><input type="date" id="leave-end-date" required></div><div class="input-group"><label for="leave-reason">Reason</label><textarea id="leave-reason" rows="3"></textarea></div><div class="modal-actions"><button type="button" class="btn btn-secondary" data-close-modal>Cancel</button><button type="submit" class="btn btn-primary">Submit</button></div></form>
        </div>
        <div id="create-user-modal" class="modal-content hidden">
            <h2>Create New User</h2>
            <form id="create-user-form"><div class="input-group"><label for="user-create-username">Username</label><input type="text" id="user-create-username" required></div><div class="input-group"><label for="user-create-fullname">Full Name</label><input type="text" id="user-create-fullname" required></div><div class="input-group"><label for="user-create-email">Email</label><input type="email" id="user-create-email" required></div><div class="input-group"><label for="user-create-password">Password</label><input type="password" id="user-create-password" required></div><div class="input-group"><label for="user-create-role">Role</label><select id="user-create-role" required><option value="ROLE_EMPLOYEE">Employee</option><option value="ROLE_MANAGER">Manager</option><option value="ROLE_ADMIN">Admin</option></select></div><div class="input-group hidden" id="manager-select-group"><label for="user-create-manager">Assign Manager</label><select id="user-create-manager"><option value="">None</option></select></div><div class="modal-actions"><button type="button" class="btn btn-secondary" data-close-modal>Cancel</button><button type="submit" class="btn btn-primary">Create User</button></div></form>
        </div>
    </div>
    <script src="/js/app.js"></script>
</body>
</html>